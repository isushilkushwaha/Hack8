<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dabur ‚Äì Herbal Wellness (Demo)</title>
  <style>
/* Product media area */
.product .media{
  aspect-ratio:4/3;
  background:var(--card);
  display:grid;
  place-items:center;
  overflow:hidden;
  border-bottom:1px solid color-mix(in oklab,var(--muted),transparent 80%);
}
.product .media img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
}

:root{
  --bg:#f7f7f8;--card:#ffffff;--text:#16181d;--muted:#6b7280;--brand:#0ea5e9;--brand-2:#22c55e;--accent:#f59e0b;--danger:#ef4444;--ring:rgba(14,165,233,.35);
}
body.dark{--bg:#0b0f14;--card:#0f141a;--text:#e5e7eb;--muted:#94a3b8;--brand:#38bdf8;--brand-2:#4ade80;--accent:#fbbf24;--danger:#f87171;--ring:rgba(56,189,248,.35)}
*{box-sizing:border-box}
html,body{margin:0;height:100%;scroll-behavior:smooth;background:var(--bg);color:var(--text);font:15px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Inter,Ubuntu,Helvetica,Arial}
a{color:inherit;text-decoration:none}
img{display:block;max-width:100%}
.container{max-width:1180px;margin:0 auto;padding:0 20px}

/* Header */
header{position:sticky;top:0;z-index:50;background:linear-gradient(180deg,var(--card),color-mix(in oklab,var(--card),transparent 6%));backdrop-filter:saturate(140%) blur(8px);border-bottom:1px solid color-mix(in oklab,var(--muted),transparent 75%)}
.nav{display:flex;align-items:center;gap:16px;padding:12px 0}
.logo{display:flex;align-items:center;gap:10px;font-weight:800}
.logo .leaf{width:28px;height:28px;border-radius:50%;background:conic-gradient(from 220deg at 50% 50%,var(--brand),var(--brand-2));box-shadow:0 0 0 3px var(--ring)}
.navlinks{display:flex;gap:16px;margin-left:auto;align-items:center}
.navlinks a{padding:8px 12px;border-radius:12px}
.navlinks a:hover{background:color-mix(in oklab,var(--brand),transparent 85%)}
.searchbar{position:relative;display:flex;align-items:center}
.searchbar input{border:1px solid color-mix(in oklab,var(--muted),transparent 70%);background:var(--card);color:var(--text);padding:8px 34px 8px 12px;border-radius:12px;outline:none}
.searchbar button{position:absolute;right:4px;border:0;background:transparent;cursor:pointer;padding:6px;border-radius:10px}
.icon{width:18px;height:18px;opacity:.8}
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid color-mix(in oklab,var(--muted),transparent 70%);background:var(--card);cursor:pointer}
.btn.primary{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;border:0}
.btn.ghost{background:transparent}
.toggle{inline-size:46px;block-size:28px;border-radius:999px;background:color-mix(in oklab,var(--muted),transparent 70%);position:relative;cursor:pointer}
.toggle i{position:absolute;inset:3px;inline-size:22px;border-radius:999px;background:var(--card);transition:transform .25s ease}
body.dark .toggle i{transform:translateX(18px)}

/* Hero */
.hero{padding:40px 0 24px;display:grid;grid-template-columns:1.2fr .8fr;gap:24px}
.hero .card{background:radial-gradient(1200px 500px at 100% 0%, color-mix(in oklab,var(--brand),transparent 85%),transparent 60%),var(--card);border:1px solid color-mix(in oklab,var(--muted),transparent 70%);padding:28px;border-radius:20px;box-shadow:0 10px 30px color-mix(in oklab,var(--text),transparent 94%)}
.hero h1{font-size:clamp(28px,4vw,42px);line-height:1.1;margin:0 0 8px}
.hero p{color:var(--muted);margin:0 0 16px}
.badges{display:flex;flex-wrap:wrap;gap:8px;margin:14px 0}
.badge{font-size:12px;padding:6px 10px;border-radius:999px;border:1px dashed color-mix(in oklab,var(--brand),transparent 50%)}
.hero-visual{position:relative;isolation:isolate}
.bottle{aspect-ratio:1/1;border-radius:22px;background:linear-gradient(140deg,color-mix(in oklab,var(--brand),transparent 75%),transparent),radial-gradient(800px 200px at 30% -20%,color-mix(in oklab,var(--accent),transparent 80%),transparent),var(--card);border:1px solid color-mix(in oklab,var(--muted),transparent 70%);display:grid;place-items:center}
.bottle svg{max-width:70%}

/* Sections */
section{padding:28px 0}
.section-head{display:flex;align-items:end;justify-content:space-between;margin-bottom:14px}
.section-head h2{margin:0;font-size:22px}
.muted{color:var(--muted)}
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
.col-3{grid-column:span 3}
.col-4{grid-column:span 4}
.col-6{grid-column:span 6}
.card{border:1px solid color-mix(in oklab,var(--muted),transparent 70%);background:var(--card);border-radius:16px;overflow:hidden}
.card-body{padding:14px}

.product{display:flex;flex-direction:column}
.product h3{font-size:16px;margin:6px 0 4px}
.price{display:flex;align-items:center;gap:8px}
.price .mrp{color:var(--muted);text-decoration:line-through}

.filters{display:flex;flex-wrap:wrap;gap:8px;margin:8px 0 12px}
.chip{padding:6px 10px;border-radius:999px;border:1px solid color-mix(in oklab,var(--muted),transparent 70%);cursor:pointer}
.chip.active{background:linear-gradient(90deg,var(--brand),var(--brand-2));color:#fff;border:0}

/* Sidebar cart */
.cart{position:fixed;top:0;right:-380px;width:360px;height:100dvh;background:var(--card);border-left:1px solid color-mix(in oklab,var(--muted),transparent 70%);box-shadow:-10px 0 30px color-mix(in oklab,var(--text),transparent 94%);transition:right .25s ease;z-index:60;display:flex;flex-direction:column}
.cart.open{right:0}
.cart header{position:sticky;top:0}
.cart-list{padding:12px;display:flex;flex-direction:column;gap:10px;overflow:auto}
.cart-item{display:grid;grid-template-columns:54px 1fr auto;gap:10px;align-items:center;border:1px solid color-mix(in oklab,var(--muted),transparent 78%);padding:8px;border-radius:12px}
.qty{display:inline-flex;align-items:center;border:1px solid color-mix(in oklab,var(--muted),transparent 70%);border-radius:10px;overflow:hidden}
.qty button{border:0;background:transparent;padding:6px 10px;cursor:pointer}
.cart-footer{margin-top:auto;padding:12px;border-top:1px solid color-mix(in oklab,var(--muted),transparent 70%);display:grid;gap:8px}

/* Compare tray */
.compare-tray{position:fixed;left:50%;transform:translateX(-50%);bottom:-220px;width:min(980px,94%);background:var(--card);border:1px solid color-mix(in oklab,var(--muted),transparent 70%);border-radius:16px 16px 0 0;box-shadow:0 -10px 30px color-mix(in oklab,var(--text),transparent 94%);transition:bottom .25s ease;z-index:40}
.compare-tray.open{bottom:12px}
.compare-head{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;border-bottom:1px solid color-mix(in oklab,var(--muted),transparent 70%)}
.compare-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;padding:10px}
.compare-cell{border:1px dashed color-mix(in oklab,var(--muted),transparent 60%);padding:10px;border-radius:12px;min-height:120px}

/* FAQ */
.accordion{display:flex;flex-direction:column;gap:8px}
.acc{border:1px solid color-mix(in oklab,var(--muted),transparent 70%);border-radius:12px;overflow:hidden}
.acc summary{list-style:none;padding:12px;cursor:pointer;background:color-mix(in oklab,var(--muted),transparent 92%)}
.acc summary::-webkit-details-marker{display:none}
.acc .acc-body{padding:12px;color:var(--muted)}

/* Footer */
footer{padding:28px 0;border-top:1px solid color-mix(in oklab,var(--muted),transparent 70%)}

/* Utilities */
.hidden{display:none}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.pill{padding:4px 10px;border-radius:999px;background:color-mix(in oklab,var(--brand),transparent 85%)}
.kbd{font:12px/1 ui-monospace, Menlo, Consolas, monospace;border:1px solid color-mix(in oklab,var(--muted),transparent 70%);padding:2px 6px;border-radius:6px}
.toast{position:fixed;bottom:16px;right:16px;background:var(--card);border:1px solid color-mix(in oklab,var(--muted),transparent 70%);padding:10px 12px;border-radius:12px;box-shadow:0 8px 24px color-mix(in oklab,var(--text),transparent 92%);z-index:80;display:none}
.toast.show{display:block}
.to-top{position:fixed;right:16px;bottom:16px;border-radius:12px}

@media (max-width:900px){
  .hero{grid-template-columns:1fr}
  .col-6{grid-column:span 12}
  .col-4{grid-column:span 12}
  .col-3{grid-column:span 6}
  .navlinks{flex-wrap:wrap}
}
  </style>
</head>
<body>
  <!-- Header / Nav -->
  <header>
    <div class="container nav">
      <a class="logo" href="#home" aria-label="Dabur Home">
        <span class="leaf"></span>
        <span>Dabur <span class="muted" style="font-weight:600">Wellness</span> <small class="pill">Demo</small></span>
      </a>
      <nav class="navlinks">
        <a href="#products">Products</a>
        <a href="#benefits">Benefits</a>
        <a href="#stores">Stores</a>
        <a href="#faq">FAQ</a>
        <span class="searchbar">
          <input id="search" type="search" placeholder="Search products (e.g., honey)" autocomplete="off" />
          <button id="clearSearch" title="Clear search"><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M18 6 6 18M6 6l12 12" stroke-width="2" stroke-linecap="round"/></svg></button>
        </span>
        <button id="toggleTheme" class="btn ghost" title="Toggle dark mode">
          <div class="toggle" aria-hidden="true"><i></i></div>
          <span class="sr">Theme</span>
        </button>
        <button id="openCart" class="btn" title="Open cart"><svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="m3 3 2 1 2 12h10l2-8H6" stroke-width="2"/><circle cx="9" cy="20" r="1.5"/><circle cx="17" cy="20" r="1.5"/></svg><span id="cartCount" class="pill">0</span></button>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <div id="home" class="container hero">
    <div class="card">
      <h1>Dabur care</h1>
      <p>Explore a curated range of daily wellness products inspired by Ayurveda‚Äîcrafted for immunity, digestion, hair & skin, and more.</p>
      <div class="badges">
        <span class="badge">No artificial colors</span>
        <span class="badge">GMP certified</span>
        <span class="badge">Cruelty-free</span>
        <span class="badge">Recyclable packaging</span>
      </div>
      <div class="row">
        <a href="#products" class="btn primary">Shop bestsellers</a>
        <a href="#benefits" class="btn">Why Ayurvedic?</a>
        <span class="muted">Press <span class="kbd">/</span> to focus search</span>
      </div>
    </div>
    <div class="hero-visual">
      <div class="bottle card">
        <!-- Simple SVG bottle/leaf illustration -->
        <svg viewBox="0 0 200 260" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <defs>
            <linearGradient id="g1" x1="0" x2="1">
              <stop offset="0" stop-color="currentColor" stop-opacity="0.15"/>
              <stop offset="1" stop-color="currentColor" stop-opacity="0.05"/>
            </linearGradient>
          </defs>
          <rect x="40" y="60" width="120" height="170" rx="22" fill="url(#g1)" stroke="currentColor" opacity=".6"/>
          <rect x="75" y="24" width="50" height="46" rx="8" fill="url(#g1)" stroke="currentColor" opacity=".6"/>
          <path d="M140 140c20-40-20-44-40-18-20 26-54 20-40-12 20-46 88-40 80 30z" fill="currentColor" opacity=".2"/>
        </svg>
      </div>
    </div>
  </div>

  <!-- Products -->
  <section id="products" class="container">
    <div class="section-head">
      <div>
        <h2>Popular Products</h2>
        <div class="muted">Filter by benefit & add to cart. Use <span class="kbd">Alt</span> + click to compare.</div>
      </div>
      <div class="filters" id="filters"></div>
    </div>
    <div id="productGrid" class="grid"></div>
  </section>

  <!-- Benefits / Content -->
  <section id="benefits" class="container">
    <div class="section-head"><h2>Why choose Ayurvedic wellness?</h2></div>
    <div class="grid">
      <div class="col-4 card"><div class="card-body"><h3>Holistic balance</h3><p class="muted">Targets root causes, not just symptoms, by balancing doshas‚ÄîVata, Pitta, Kapha.</p></div></div>
      <div class="col-4 card"><div class="card-body"><h3>Daily-use friendly</h3><p class="muted">Routine-based products crafted for immunity, gut health, hair, skin, and oral care.</p></div></div>
      <div class="col-4 card"><div class="card-body"><h3>Trusted ingredients</h3><p class="muted">Honey, Amla, Ashwagandha, Tulsi, and more‚Äîsourced responsibly.</p></div></div>
    </div>
  </section>

  <!-- Store locator -->
  <section id="stores" class="container">
    <div class="section-head">
      <h2>Find a store near you</h2>
      <div class="row">
        <input id="storeQuery" placeholder="Enter city or pincode" class="btn" style="min-width:230px" />
        <button id="searchStore" class="btn">Search</button>
      </div>
    </div>
    <div class="grid">
      <div class="col-6 card"><div class="card-body">
        <h3>Map</h3>
        <iframe id="mapFrame" title="Map" src="https://www.openstreetmap.org/export/embed.html?bbox=72.77%2C18.89%2C72.99%2C19.28&layer=mapnik" style="width:100%;height:320px;border:0;border-radius:12px"></iframe>
      </div></div>
      <div class="col-6 card"><div class="card-body">
        <h3>Suggested stores</h3>
        <ul id="storeList" class="muted" style="padding-left:18px">
          <li>Dabur Wellness Outlet ‚Äì Colaba, Mumbai</li>
          <li>AyurHub ‚Äì Andheri West, Mumbai</li>
          <li>GreenLife Pharmacy ‚Äì Bandra, Mumbai</li>
        </ul>
      </div></div>
    </div>
  </section>

  <!-- Newsletter -->
  <section class="container">
    <div class="grid">
      <div class="col-6 card"><div class="card-body">
        <h3>Get deals & health tips</h3>
        <p class="muted">Subscribe to our monthly newsletter. No spam, unsubscribe anytime.</p>
        <div class="row">
          <input id="email" type="email" placeholder="your@email.com" class="btn" style="min-width:220px" />
          <button id="subscribe" class="btn primary">Subscribe</button>
        </div>
        <small id="emailMsg" class="muted"></small>
      </div></div>
      <div class="col-6 card"><div class="card-body">
        <h3>Wellness tip of the day</h3>
        <p id="tip" class="muted">Hydrate first thing in the morning to kickstart metabolism and digestion.</p>
        <button id="newTip" class="btn">New tip</button>
      </div></div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="container">
    <div class="section-head"><h2>FAQs</h2></div>
    <div class="accordion">
      <details class="acc"><summary>Are these products safe for daily use?</summary><div class="acc-body">Yes, formulated for regular use. Always follow label instructions and consult your physician if you have specific conditions.</div></details>
      <details class="acc"><summary>Do you ship internationally?</summary><div class="acc-body">This demo simulates a store experience. In a real deployment, shipping partners and rates would be shown at checkout.</div></details>
      <details class="acc"><summary>Can I return a product?</summary><div class="acc-body">Returns are accepted within 7‚Äì14 days in most regions if the product is unopened or defective. Retain invoice.</div></details>
    </div>
  </section>

  <!-- Footer -->
  <footer class="container">
    <div class="row" style="justify-content:space-between">
      <p class="muted">¬© <span id="year"></span> Dabur Wellness (Demo). Built with vanilla HTML, CSS & JS.</p>
      <div class="row">
        <a href="#home" class="btn">Back to top</a>
        <button id="toTop" class="btn to-top">‚Üë</button>
      </div>
    </div>
  </footer>

  <!-- Cart Sidebar -->
  <aside id="cart" class="cart" aria-label="Shopping cart" aria-hidden="true">
    <header class="container nav">
      <strong>My Cart</strong>
      <button id="closeCart" class="btn" style="margin-left:auto">Close</button>
    </header>
    <div id="cartList" class="cart-list"></div>
    <div class="cart-footer">
      <div class="row" style="justify-content:space-between"><strong>Total</strong><strong id="cartTotal">‚Çπ0</strong></div>
      <button class="btn primary" id="checkout">Checkout</button>
      <small class="muted">Demo checkout only. No real payments.</small>
    </div>
  </aside>

  <!-- Compare Tray -->
  <div class="compare-tray" id="compareTray">
    <div class="compare-head">
      <strong>Compare (2)</strong>
      <div class="row">
        <button id="clearCompare" class="btn">Clear</button>
        <button id="closeCompare" class="btn">Hide</button>
      </div>
    </div>
    <div class="compare-grid">
      <div class="compare-cell" id="cmpA">Drop/Alt-click a product to compare</div>
      <div class="compare-cell" id="cmpB"></div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script>
// ================== MEDIA HELPERS ==================
const IMG = {
  // Make sure these files exist in the same folder as this HTML:
  honey:         "download.jpg",
  chyawanprash:  "chyawanprash.jpg",
  amla:          "amlajuice.jpg",
  ashwagandha:   "ashwagandha.jpg",
  redpaste:      "redpaste.jpg",
  gulabari:      "gulabrose.jpg",
  lalTail:       "laltail.jpg",
  hingoli:       "hingoli.jpg"
};

function svgPlaceholder(label){
  const text = (label||"IMAGE").toUpperCase();
  return `<div class="media">
    <svg width="120" height="80" viewBox="0 0 120 80" fill="none" stroke="currentColor">
      <rect x="6" y="6" width="108" height="68" rx="10" opacity=".25"/>
      <text x="60" y="44" text-anchor="middle" font-size="12" opacity=".6">${text}</text>
    </svg>
  </div>`;
}

function mediaHTML(p){
  const src = IMG[p.img];              // p.img must match a key in IMG
  if(!src) return svgPlaceholder(p.img);
  return `<div class="media">
    <img loading="lazy" alt="${p.name}" src="${src}"
         onerror="this.replaceWith(document.createRange().createContextualFragment(\`${svgPlaceholder(p.img)}\`))">
  </div>`;
}

// ================== DATA ==================
const PRODUCTS = [
  {id:"honey",         name:"Dabur Honey",            price:285, mrp:325, benefit:"immunity", rating:4.7, desc:"Pure honey for daily immunity & energy.",            img:"honey"},
  {id:"chyawanprash",  name:"Dabur Chyawanprash",     price:395, mrp:430, benefit:"immunity", rating:4.8, desc:"Amla-based classical formulation.",                  img:"chyawanprash"},
  {id:"amla",          name:"Amla Juice",             price:210, mrp:240, benefit:"digestion",rating:4.4, desc:"Vitamin C rich, supports digestion & skin.",         img:"amla"},
  {id:"ashwagandha",   name:"Ashwagandha Tablets",    price:249, mrp:299, benefit:"stress",   rating:4.5, desc:"Adaptogen for stress & sleep.",                    img:"ashwagandha"},
  {id:"redpaste",      name:"Red Paste",              price:110, mrp:130, benefit:"oral",     rating:4.2, desc:"Clove & mint fortified oral care.",               img:"redpaste"},
  {id:"gulabari",      name:"Gulabari Rose Water",    price:85,  mrp:95,  benefit:"skin",     rating:4.3, desc:"Steam-distilled toner for fresh skin.",           img:"gulabrose"},
  {id:"lalTail",       name:"Lal Tail",               price:175, mrp:199, benefit:"baby",     rating:4.6, desc:"Ayurvedic baby massage oil.",                     img:"lalTail"},
  {id:"hingoli",       name:"Hingoli",                price:45,  mrp:55,  benefit:"digestion",rating:4.1, desc:"Hing goli for quick digestion relief.",           img:"hingoli"},
];

const BENEFITS = [
  {key:"all", label:"All"},
  {key:"immunity", label:"Immunity"},
  {key:"digestion", label:"Digestion"},
  {key:"stress", label:"Stress/Sleep"},
  {key:"skin", label:"Skin"},
  {key:"oral", label:"Oral Care"},
  {key:"baby", label:"Baby Care"},
];

// ================== UTILS ==================
const $  = sel => document.querySelector(sel);
const $$ = sel => Array.from(document.querySelectorAll(sel));
const money = n => `‚Çπ${n.toLocaleString('en-IN')}`;
const toast = (msg) => { const t = $('#toast'); t.textContent = msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'), 1500); };

// Theme
(function initTheme(){
  const saved = localStorage.getItem('theme');
  if(saved === 'dark' || (!saved && window.matchMedia('(prefers-color-scheme: dark)').matches)){
    document.body.classList.add('dark');
  }
  $('#toggleTheme').addEventListener('click', () => {
    document.body.classList.toggle('dark');
    localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
  });
})();

// Search keyboard focus
document.addEventListener('keydown', (e)=>{
  if(e.key==='/' && !/input|textarea/i.test(document.activeElement.tagName)){
    e.preventDefault(); $('#search').focus();
  }
});

// ================== FILTERS ==================
const filtersEl = $('#filters');
let activeFilter = 'all';
function renderFilters(){
  filtersEl.innerHTML = BENEFITS.map(b => `<button class="chip ${b.key===activeFilter?'active':''}" data-key="${b.key}">${b.label}</button>`).join('');
  filtersEl.querySelectorAll('.chip').forEach(ch=>ch.addEventListener('click',()=>{
    activeFilter=ch.dataset.key; renderProducts(); document.getElementById('products').scrollIntoView({behavior:'smooth'});
  }));
}

// ================== PRODUCTS GRID ==================
const grid = $('#productGrid');

function productCard(p){
  return `<article class="product card" data-id="${p.id}" data-benefit="${p.benefit}" tabindex="0">
    ${mediaHTML(p)}
    <div class="card-body">
      <div class="row" style="justify-content:space-between">
        <h3>${p.name}</h3>
        <span class="pill" title="Rating">‚≠ê ${p.rating}</span>
      </div>
      <p class="muted" style="min-height:36px">${p.desc}</p>
      <div class="row" style="justify-content:space-between;align-items:center">
        <div class="price"><strong>${money(p.price)}</strong> <span class="mrp">${money(p.mrp)}</span></div>
        <div class="row">
          <button class="btn" data-act="quick">Quick view</button>
          <button class="btn primary" data-act="add">Add</button>
        </div>
      </div>
    </div>
  </article>`;
}

function renderProducts(){
  const q = $('#search').value.trim().toLowerCase();
  const list = PRODUCTS.filter(p =>
    (activeFilter==='all' || p.benefit===activeFilter) &&
    (!q || p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q))
  );
  grid.className = 'grid';
  grid.innerHTML = list.map(productCard).join('');
  // responsive columns based on width
  const cols = window.innerWidth>1100? 4 : window.innerWidth>900? 3 : 2;
  grid.style.gridTemplateColumns = `repeat(${cols},1fr)`;
  grid.querySelectorAll('.product .btn').forEach(btn=>btn.addEventListener('click', onProductAction));
  grid.querySelectorAll('.product').forEach(card=>card.addEventListener('click', (e)=>{
    if(e.altKey){ addToCompare(card.dataset.id); }
  }));
}
window.addEventListener('resize', ()=>renderProducts());

// Search handlers
$('#search').addEventListener('input', renderProducts);
$('#clearSearch').addEventListener('click', ()=>{ $('#search').value=''; renderProducts(); });

// ================== QUICK VIEW ==================
function onProductAction(e){
  const id = e.currentTarget.closest('.product').dataset.id;
  const p = PRODUCTS.find(x=>x.id===id);
  const act = e.currentTarget.dataset.act;
  if(act==='add') addToCart(p);
  if(act==='quick'){
    const html = `<div class="card" style="position:fixed;inset:0;display:grid;place-items:center;background:rgba(0,0,0,.35);z-index:70">
      <div class="card" style="max-width:560px;width:92%;padding:14px;border-radius:16px;background:var(--card)">
        <div class="row" style="justify-content:space-between;align-items:center"><h3>${p.name}</h3><button class="btn" id="closeModal">‚úï</button></div>
        <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px">
          ${mediaHTML(p)}
          <div>
            <p class="muted">${p.desc}</p>
            <p><strong>Benefits:</strong> ${p.benefit}</p>
            <p><strong>Rating:</strong> ‚≠ê ${p.rating}</p>
            <div class="row"><button class="btn primary" id="addFromModal">Add to cart ‚Äì ${money(p.price)}</button></div>
          </div>
        </div>
      </div>
    </div>`;
    const wrap = document.createElement('div');
    wrap.innerHTML = html; document.body.appendChild(wrap);
    wrap.addEventListener('click',(ev)=>{ if(ev.target===wrap.firstElementChild) wrap.remove(); });
    wrap.querySelector('#closeModal').onclick=()=>wrap.remove();
    wrap.querySelector('#addFromModal').onclick=()=>{ addToCart(p); wrap.remove(); };
  }
}

// ================== CART ==================
const CART_KEY = 'dabur_demo_cart';
let cart = JSON.parse(localStorage.getItem(CART_KEY) || '[]');

function saveCart(){ localStorage.setItem(CART_KEY, JSON.stringify(cart)); }
function addToCart(p){ const row = cart.find(i=>i.id===p.id); if(row){ row.qty++; } else { cart.push({id:p.id, name:p.name, price:p.price, qty:1}); } saveCart(); renderCart(); toast('Added to cart'); updateCartCount(); }
function removeFromCart(id){ cart = cart.filter(i=>i.id!==id); saveCart(); renderCart(); updateCartCount(); }
function setQty(id, q){ const row = cart.find(i=>i.id===id); if(!row) return; row.qty = Math.max(1, q); saveCart(); renderCart(); updateCartCount(); }
function cartTotal(){ return cart.reduce((s,i)=>s + i.price*i.qty, 0); }
function updateCartCount(){ $('#cartCount').textContent = cart.reduce((s,i)=>s+i.qty,0); }

function renderCart(){
  const list = $('#cartList');
  list.innerHTML = cart.length? '' : '<p class="muted">Your cart is empty.</p>';
  cart.forEach(i=>{
    const el = document.createElement('div'); el.className='cart-item';
    el.innerHTML = `<div style="width:54px;height:54px;border-radius:10px;background:color-mix(in oklab,var(--brand),transparent 85%);display:grid;place-items:center">üõçÔ∏è</div>
      <div><strong>${i.name}</strong><div class="muted">${money(i.price)}</div></div>
      <div style="display:grid;gap:6px;justify-items:end">
        <div class="qty"><button aria-label="Decrease">‚Äì</button><span style="padding:0 10px">${i.qty}</span><button aria-label="Increase">+</button></div>
        <button class="btn" data-remove>Remove</button>
      </div>`;
    const [minus, , plus] = el.querySelectorAll('.qty button, .qty span');
    minus.addEventListener('click',()=>setQty(i.id, i.qty-1));
    plus.addEventListener('click',()=>setQty(i.id, i.qty+1));
    el.querySelector('[data-remove]').addEventListener('click',()=>removeFromCart(i.id));
    list.appendChild(el);
  });
  $('#cartTotal').textContent = money(cartTotal());
}

// Cart open/close
const cartEl = $('#cart');
const openCart = ()=>{ cartEl.classList.add('open'); cartEl.setAttribute('aria-hidden','false'); };
const closeCart = ()=>{ cartEl.classList.remove('open'); cartEl.setAttribute('aria-hidden','true'); };
$('#openCart').addEventListener('click', openCart);
$('#closeCart').addEventListener('click', closeCart);
$('#checkout').addEventListener('click', ()=>{ toast('Checkout is a demo.'); });

// ================== COMPARE ==================
const CMP_KEY = 'dabur_demo_cmp';
let compare = JSON.parse(localStorage.getItem(CMP_KEY) || '[]');
function addToCompare(id){
  if(!compare.includes(id)) compare.push(id);
  if(compare.length>2) compare = compare.slice(-2);
  localStorage.setItem(CMP_KEY, JSON.stringify(compare));
  renderCompare(); toast('Added to compare');
}
function renderCompare(){
  const tray = $('#compareTray');
  const a = $('#cmpA'), b = $('#cmpB');
  if(compare.length===0){ tray.classList.remove('open'); a.textContent='Drop/Alt-click a product to compare'; b.textContent=''; return; }
  tray.classList.add('open');
  const [p1,p2] = compare.map(id=>PRODUCTS.find(p=>p.id===id));
  a.innerHTML = p1? compHTML(p1) : 'Add first product';
  b.innerHTML = p2? compHTML(p2) : 'Add second product';
}
function compHTML(p){
  return `<strong>${p.name}</strong><div class="muted">Benefit: ${p.benefit}</div><div>Price: ${money(p.price)} <span class="muted">(${money(p.mrp)})</span></div><div>Rating: ‚≠ê ${p.rating}</div>`;
}
$('#clearCompare').addEventListener('click',()=>{ compare=[]; localStorage.setItem(CMP_KEY,'[]'); renderCompare(); });
$('#closeCompare').addEventListener('click',()=>$('#compareTray').classList.remove('open'));

// ================== NEWSLETTER ==================
$('#subscribe').addEventListener('click', ()=>{
  const email = $('#email').value.trim();
  const msg = $('#emailMsg');
  if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)){ msg.textContent='Please enter a valid email.'; msg.style.color='var(--danger)'; return; }
  msg.textContent='Thanks for subscribing!'; msg.style.color='var(--brand-2)';
});

// ================== TIPS ==================
const TIPS = [
  'Sip warm water with lemon to aid digestion.',
  'Follow a consistent sleep schedule for better recovery.',
  'Take a 5-minute stretch break every hour.',
  'Add a teaspoon of honey to lukewarm water for a soothing drink.',
  'Practice 4-7-8 breathing to reduce stress quickly.'
];
$('#newTip').addEventListener('click', ()=>{ $('#tip').textContent = TIPS[Math.floor(Math.random()*TIPS.length)]; });

// ================== STORE LOCATOR (demo) ==================
$('#searchStore').addEventListener('click', ()=>{
  const q = $('#storeQuery').value.toLowerCase();
  const list = $('#storeList');
  if(!q){ toast('Enter a city or pincode'); return; }
  list.innerHTML = '';
  const suggestions = [
    {city:'mumbai', stores:['Dabur Wellness ‚Äì Colaba','AyurHub ‚Äì Andheri','GreenLife ‚Äì Bandra'], bbox:'72.77%2C18.89%2C72.99%2C19.28'},
    {city:'delhi', stores:['Dabur Care ‚Äì Connaught Place','HerbNest ‚Äì Lajpat Nagar'], bbox:'77.09%2C28.52%2C77.29%2C28.72'},
    {city:'bengaluru', stores:['AyurKart ‚Äì Indiranagar','NatureCare ‚Äì Koramangala'], bbox:'77.55%2C12.87%2C77.69%2C13.08'},
  ];
  const found = suggestions.find(s => q.includes(s.city) || q.includes(s.city.slice(0,3)));
  if(found){
    list.innerHTML = found.stores.map(s=>`<li>${s}</li>`).join('');
    document.getElementById('mapFrame').src = `https://www.openstreetmap.org/export/embed.html?bbox=${found.bbox}&layer=mapnik`;
  } else {
    list.innerHTML = '<li>No nearby stores found in demo. Try Mumbai/Delhi/Bengaluru.</li>';
  }
});

// ================== MISC ==================
$('#toTop').addEventListener('click', ()=> window.scrollTo({top:0, behavior:'smooth'}));

function init(){
  renderFilters();
  renderProducts();
  renderCart();
  renderCompare();
  updateCartCount();
  $('#year').textContent = new Date().getFullYear();
}
init();
  </script>
</body>
</html>
